# Business Card Manager - 要件定義書

## プロジェクト概要

**プロジェクト名**: Business Card Manager
**目的**: 実践的Rails開発スキル習得
**開発期間**: 2025年9月11日〜継続中
**技術スタック**: Rails 8.0 + MySQL + Bootstrap 5 + React/TypeScript
**開発環境**: devcontainer使用

## ビジネス要件

### 背景・目的
- 技術実装への挑戦
- Java経験者のRuby/Rails移行学習の実証
- 実用的な名刺管理システムの構築による技術力証明

### ターゲットユーザー
- ビジネスパーソン（個人利用）
- 営業担当者
- ネットワーキングを重視する専門職

## 機能要件

### Requirement 1: ユーザー管理機能 ✅ **実装済み**

**User Story**: ユーザーとして、アカウントを作成・管理できるようにしたい

#### Acceptance Criteria
1. WHEN ユーザーが新規登録フォームにアクセス THEN システムは名前、メールアドレス、パスワードの入力フォームを表示する
2. WHEN ユーザーが有効な情報で登録 THEN システムはアカウントを作成し、確認メールを送信する
3. WHEN ユーザーがログインフォームで認証情報を入力 THEN システムは認証を行い、成功時にダッシュボードにリダイレクトする
4. WHEN ユーザーがプロフィール編集画面にアクセス THEN システムは現在の情報を表示し、編集可能にする
5. IF ユーザーがパスワードリセットを要求 THEN システムはリセットリンクをメールで送信する

### Requirement 2: 名刺CRUD機能 ✅ **実装済み**

**User Story**: ユーザーとして、名刺情報を登録・管理できるようにしたい

#### Acceptance Criteria
1. WHEN ユーザーが名刺登録フォームにアクセス THEN システムは名前、会社名、役職、連絡先の入力フォームを表示する
2. WHEN ユーザーが必須項目（名前、会社名）を入力して保存 THEN システムは名刺を作成し、一覧画面にリダイレクトする
3. WHEN ユーザーが名刺一覧画面にアクセス THEN システムは登録済み名刺をカード形式で表示する
4. WHEN ユーザーが名刺詳細画面にアクセス THEN システムは名刺の全情報と関連する類似名刺を表示する
5. WHEN ユーザーが名刺編集フォームで情報を更新 THEN システムは変更を保存し、詳細画面にリダイレクトする
6. WHEN ユーザーが名刺削除を実行 THEN システムは確認ダイアログを表示し、確認後に削除する

### Requirement 3: 検索・フィルタリング機能 ✅ **実装済み**

**User Story**: ユーザーとして、大量の名刺から目的の名刺を素早く見つけたい

#### Acceptance Criteria
1. WHEN ユーザーが検索ボックスにキーワードを入力 THEN システムは名前、会社名、役職から部分一致検索を実行する
2. WHEN ユーザーが会社名フィルターを選択 THEN システムは該当する会社の名刺のみを表示する
3. WHEN ユーザーがタグフィルターを選択 THEN システムは該当するタグが付いた名刺のみを表示する
4. WHEN ユーザーが複数の検索条件を組み合わせ THEN システムはAND条件で絞り込み結果を表示する
5. IF 検索結果が0件の場合 THEN システムは「該当する名刺が見つかりません」メッセージを表示する

### Requirement 4: タグ管理機能 ✅ **実装済み**

**User Story**: ユーザーとして、名刺を分類・整理するためのタグを管理したい

#### Acceptance Criteria
1. WHEN ユーザーが名刺登録・編集時にタグを入力 THEN システムはカンマ区切りでタグを受け付ける
2. WHEN ユーザーが新しいタグを入力 THEN システムは自動的にタグを作成し、名刺に関連付ける
3. WHEN ユーザーがタグ管理画面にアクセス THEN システムは全タグと使用回数を表示する
4. WHEN ユーザーがタグを編集 THEN システムはタグ名と色を変更可能にする
5. WHEN ユーザーが未使用のタグを削除 THEN システムはタグを完全に削除する
6. IF タグが使用中の場合 THEN システムは削除を拒否し、警告メッセージを表示する

### Requirement 5: 画像アップロード機能 ✅ **実装済み**

**User Story**: ユーザーとして、名刺の写真を保存して視覚的に管理したい

#### Acceptance Criteria
1. WHEN ユーザーが名刺登録・編集フォームで画像を選択 THEN システムは画像プレビューを表示する
2. WHEN ユーザーが対応形式（JPEG、PNG）の画像をアップロード THEN システムは画像を保存し、名刺に関連付ける
3. WHEN ユーザーが大きすぎる画像をアップロード THEN システムは自動的にリサイズして保存する
4. WHEN ユーザーが名刺一覧・詳細画面を表示 THEN システムは最適化された画像を表示する
5. IF ユーザーが非対応形式をアップロード THEN システムはエラーメッセージを表示する

### Requirement 6: 統計・分析機能 🔄 **実装中**

**User Story**: ユーザーとして、名刺データの統計情報を確認したい

#### Acceptance Criteria
1. WHEN ユーザーがダッシュボードにアクセス THEN システムは総名刺数、企業数、連絡可能数を表示する
2. WHEN ユーザーが分析画面にアクセス THEN システムは月別登録数のグラフを表示する
3. WHEN ユーザーが企業別統計を確認 THEN システムは名刺数上位10社をグラフで表示する
4. WHEN ユーザーがタグ別統計を確認 THEN システムは使用頻度上位10タグをグラフで表示する
5. WHEN ユーザーが期間を指定 THEN システムは指定期間内の統計データを表示する

### Requirement 7: データエクスポート機能 🔄 **実装中**

**User Story**: ユーザーとして、名刺データを外部で利用するためにエクスポートしたい

#### Acceptance Criteria
1. WHEN ユーザーがエクスポート機能にアクセス THEN システムはCSV、JSON形式の選択肢を表示する
2. WHEN ユーザーがCSV形式を選択 THEN システムは全名刺データをCSV形式でダウンロード提供する
3. WHEN ユーザーがJSON形式を選択 THEN システムはタグ情報を含む詳細データをJSON形式で提供する
4. WHEN ユーザーが検索・フィルター適用後にエクスポート THEN システムは絞り込み結果のみをエクスポートする
5. IF エクスポート対象が0件の場合 THEN システムは警告メッセージを表示し、処理を中断する

### Requirement 8: OCR・自動データ抽出機能 🔄 **実装中**

**User Story**: ユーザーとして、名刺画像から自動的に情報を抽出して入力の手間を省きたい

#### Acceptance Criteria
1. WHEN ユーザーが名刺画像をアップロード THEN システムはOCR処理を実行し、テキストを抽出する
2. WHEN OCR処理が完了 THEN システムは抽出されたデータを構造化してフォームに自動入力する
3. WHEN OCR結果に信頼度スコアが付与 THEN システムは低信頼度項目をハイライト表示する
4. WHEN ユーザーがOCR結果を確認・修正 THEN システムは修正内容を学習データとして活用する
5. IF OCR処理が失敗した場合 THEN システムは手動入力モードに切り替える

### Requirement 9: データ品質管理機能 🔴 **未実装**

**User Story**: ユーザーとして、名刺データの品質を自動的に向上させたい

#### Acceptance Criteria
1. WHEN 名刺データが登録・更新 THEN システムはデータ品質スコアを算出する
2. WHEN 重複する可能性のある名刺を検出 THEN システムはマージ提案を表示する
3. WHEN 不完全なデータを検出 THEN システムは補完候補を提案する
4. WHEN データ検証が実行 THEN システムは検証ステータスを更新する
5. IF 品質スコアが低い場合 THEN システムは改善提案を表示する

### Requirement 10: 人脈ネットワーク分析機能 🔄 **実装中**

**User Story**: ユーザーとして、人脈の関係性や接触頻度を可視化して管理したい

#### Acceptance Criteria
1. WHEN ユーザーが人脈分析画面にアクセス THEN システムは人脈ネットワーク図を表示する
2. WHEN ユーザーが接触履歴を記録 THEN システムは接触頻度と関係強度を更新する
3. WHEN システムが関係性を分析 THEN 推奨コンタクト相手を提案する
4. WHEN ユーザーが特定の人物を選択 THEN システムは関連する人脈を表示する
5. WHEN 長期間接触のない人脈を検出 THEN システムはフォローアップを提案する

### Requirement 11: レスポンシブUI ✅ **実装済み**

**User Story**: ユーザーとして、スマートフォンやタブレットでも快適に名刺管理したい

#### Acceptance Criteria
1. WHEN ユーザーがモバイルデバイスでアクセス THEN システムはモバイル最適化されたレイアウトを表示する
2. WHEN ユーザーがタブレットでアクセス THEN システムはタブレット向けの中間レイアウトを表示する
3. WHEN ユーザーが画面サイズを変更 THEN システムは動的にレイアウトを調整する
4. WHEN ユーザーがモバイルで名刺一覧を表示 THEN システムは1列レイアウトで表示する
5. WHEN ユーザーがモバイルで検索機能を使用 THEN システムは使いやすい検索インターフェースを提供する

### Requirement 12: フロントエンド技術スタック近代化 ✅ **実装済み**

**User Story**: ユーザーとして、より高速で直感的な操作性を持つモダンなWebアプリケーション体験を得たい

#### Acceptance Criteria
1. WHEN ユーザーが名刺一覧にアクセス THEN システムは型安全なTypeScriptとReactによる高速な画面表示を提供する
2. WHEN ユーザーが検索・フィルタリング操作を実行 THEN システムはページリロードなしに即座に結果を更新表示する
3. WHEN ユーザーが名刺の削除・編集操作を行う THEN システムはReactコンポーネントベースの直感的なモーダル・フォーム体験を提供する
4. WHEN ユーザーが複数の画面間を移動する THEN システムはReduxによる一貫した状態管理で滑らかな操作体験を提供する
5. WHEN 開発者がフロントエンド機能を追加・修正 THEN TypeScriptの型安全性により実行時エラーを事前に防止できる

#### Technical Requirements
1. **段階的移行**: 既存のRails ERBビューからReactコンポーネントへの段階的な置き換えを実現する
2. **API統合**: Rails APIとTypeScript/React間の型安全な通信を確立する
3. **状態管理**: Redux Toolkit による予測可能な状態管理を実装する
4. **開発体験**: esbuild による高速ビルド環境とESLintによる品質管理を提供する
5. **後方互換性**: 既存のRails認証・セッション管理システムとの統合を維持する

## 非機能要件

### パフォーマンス要件
- ページ読み込み時間: 3秒以内
- 検索レスポンス時間: 1秒以内
- 画像アップロード処理時間: 5秒以内
- 同時ユーザー数: 100ユーザー対応

### セキュリティ要件
- パスワードハッシュ化（bcrypt使用）
- CSRF攻撃対策
- SQLインジェクション対策
- XSS攻撃対策
- セッション管理の適切な実装

### 可用性要件
- システム稼働率: 99%以上
- データバックアップ: 日次自動バックアップ
- 障害復旧時間: 4時間以内

### 互換性要件
- ブラウザ対応: Chrome、Firefox、Safari、Edge（最新版）
- モバイル対応: iOS Safari、Android Chrome
- 画面解像度: 320px〜1920px対応

## 技術制約

### 開発環境
- devcontainer使用による環境統一
- Docker Compose による開発環境構築
- VS Code Dev Containers拡張機能使用

### 技術スタック制約
- バックエンド: Ruby on Rails 7.0以上
- データベース: MySQL 8.0
- フロントエンド: Bootstrap 5 + Stimulus（基本）、React/TypeScript（ダッシュボード）
- 画像ストレージ: Active Storage（開発）、AWS S3（本番）
- デプロイ: Heroku（初期）、AWS（将来）

### 開発制約
- テスト駆動開発（TDD）の実践
- Rails Wayに準拠した実装
- Git/GitHub による版本管理
- 継続的インテグレーション（CI）の実装

## 成功基準

### 技術的成功基準
- 全機能要件の実装完了
- テストカバレッジ80%以上
- パフォーマンス要件の達成
- セキュリティ要件の満足

### ビジネス的成功基準
- Ruby/Rails習得の実証
- プロダクト開発思考の体現
- 継続学習能力の証明

## リスク・制約事項

### 技術リスク
- Ruby/Rails学習進捗の遅れ
- 複雑な機能実装での技術的困難
- パフォーマンス要件未達成

### スケジュールリスク
- 学習時間の確保困難
- 他業務との兼ね合い
- 想定以上の実装時間

### 対策
- 段階的実装によるリスク分散
- MVP（最小実行可能プロダクト）優先
- 継続的な進捗確認と調整
