# CLAUDE.md

このファイルは、Claude Code (claude.ai/code) がこのリポジトリで作業する際の指針を提供します。

## プロジェクト概要

Business Card Managerは、名刺管理のためのRails 8.0アプリケーションです。Ruby/Railsの習得を実証するための学習プロジェクトとして構築されています。基本的な名刺管理システム（認証・CRUD）、React/TypeScript統合、インタラクティブ機能が完成しており、現在は高度機能（OCR、エクスポート、分析）の実装を進めています。

## 開発環境

このプロジェクトは、開発にdevcontainerとDocker Composeを使用する設計になっています：

- **Ruby**: 3.3（YJITを有効化）
- **Rails**: 8.0
- **データベース**: MySQL 8.0
- **フロントエンド**: Bootstrap 5 + Stimulus（基本UI）、React/TypeScript（ダッシュボード）
- **開発環境**: VS Code + Dev Containers

## 主要ドキュメント

プロジェクトには`.kiro/specs/namecard-manager/`に詳細な企画ドキュメントがあります：

- `requirements.md` - 受け入れ基準を含む詳細な機能要件
- `design.md` - システムアーキテクチャとデータベース設計
- `tasks.md` - 実装タスクとプロジェクト計画
- `README.md` - プロジェクト概要と技術スタック
- `DEVELOP.md` - 開発ガイドラインとベストプラクティス

## プロジェクト状況

**実装済み機能**：
- ✅ 基本的な名刺管理システム（ユーザー認証・CRUD操作）
- ✅ React/TypeScript統合とモダンフロントエンド
- ✅ インタラクティブ機能とユーザビリティ改善
- ✅ テスト環境（RSpec、Jest）の構築

**実装中の機能**：
- 🔄 OCR処理による名刺画像からのデータ抽出
- 🔄 データエクスポート機能
- 🔄 統計・分析ダッシュボード
- 🔄 ネットワーク分析機能

動作可能なWebアプリケーションとして機能し、継続的に機能追加を行っています。

## 開発コマンド

現在利用可能な開発コマンド：

### サーバー起動
- `rails server` - 開発サーバーの起動（http://localhost:3000）
- `bin/dev` - フォアマンによるRails + フロントエンドアセット同時起動

### データベース操作
- `rails db:create db:migrate db:seed` - データベースのセットアップ
- `rails db:reset` - データベースのリセットと再構築

### テスト実行
- `bundle exec rspec` - Ruby/Railsテストの実行
- `npm test` - JavaScript/TypeScriptテストの実行
- `npm run test:coverage` - カバレッジ付きテスト実行

### コード品質チェック
- `npm run lint` - ESLintによるJavaScript/TypeScriptコードの構文チェック
- `npm run type-check` - TypeScriptの型チェック
- `npm run build` - プロダクション用アセットのビルド

### その他
- `rails console` - Railsコンソールの起動
- `rails generate` - ジェネレーターの実行
- `bundle install` - Gemの依存関係更新

## アーキテクチャ

計画されたアーキテクチャは、サービス層を追加したRails規約に従います：

- **MVCパターン**: 標準的なRailsコントローラー、モデル、ビュー
- **サービス層**: 複雑な操作（OCR、データ品質、分析）のビジネスロジック
- **API層**: Reactダッシュボードコンポーネント用のJSON API
- **バックグラウンドジョブ**: 画像処理とデータ分析用

## 主要機能

### 実装済み機能
- ✅ **ユーザー認証と管理** - Deviseによる安全な認証システム
- ✅ **名刺のCRUD操作** - 作成、表示、更新、削除の完全対応
- ✅ **タグ管理と分類** - 柔軟なタグ付けシステム
- ✅ **検索とフィルタリング** - 名前、会社、タグによる検索
- ✅ **レスポンシブUI** - Bootstrap 5 + Stimulusによるモダンインターフェース
- ✅ **React統合** - TypeScript対応のReactコンポーネント

### 実装中・計画中機能
- 🔄 **画像アップロードとOCR処理** - 名刺画像からの自動データ抽出
- 🔄 **統計・分析ダッシュボード** - 名刺データの可視化と分析
- 🔄 **データエクスポート機能** - CSV、PDF等への出力
- 🔄 **ネットワーク分析と関係性マッピング** - 人脈関係の可視化

## 開発スタイル

このプロジェクトは**学習目的のペアプログラミング**で行います：

### 役割分担
- **Claude（指示者）**: コードは書かない。具体的な実装指示、技術解説、学習ポイントの提供のみ
- **開発者（操作者）**: 全てのファイル編集、コマンド実行、実際の実装作業を担当
- **重要**: 学習効果を最大化するため、開発者が実際に手を動かしてRailsスキルを習得する

## 開発アプローチ

### テスト駆動開発（TDD）サイクル
このプロジェクトではTDDサイクルを厳密に守って開発を進めます：

1. **REDフェーズ** - 失敗するテストを書く
   - 機能要件に基づいてテストを先に作成
   - テストが失敗することを確認（まだ実装がないため）
   - テストが適切に失敗する理由を明確にする

2. **GREENフェーズ** - テストを通す最小限のコードを書く
   - テストをパスするための最小限の実装を行う
   - コードの品質よりもテストを通すことを優先
   - すべてのテストがパスすることを確認

3. **REFACTORINGフェーズ** - コードを改善する
   - テストを壊さずにコードをリファクタリング
   - Rails規約への準拠、コードの可読性向上
   - パフォーマンス最適化とセキュリティ要件の確認

### その他の重要な方針
- RSpecによるテストカバレッジ80%以上を維持
- Rails Wayの規約
- 複雑なビジネスロジックのためのサービスオブジェクト
- Reactコンポーネント用のAPI-firstデザイン
- セキュリティベストプラクティス
- YJITと適切なインデックスによるパフォーマンス最適化
